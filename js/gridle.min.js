window.matchMedia||(window.matchMedia=function(){"use strict";var a=window.styleMedia||window.media;if(!a){var b=document.createElement("style"),c=document.getElementsByTagName("script")[0],d=null;b.type="text/css",b.id="matchmediajs-test",c.parentNode.insertBefore(b,c),d="getComputedStyle"in window&&window.getComputedStyle(b,null)||b.currentStyle,a={matchMedium:function(a){var c="@media "+a+"{ #matchmediajs-test { width: 1px; } }";return b.styleSheet?b.styleSheet.cssText=c:b.textContent=c,"1px"===d.width}}}return function(b){return{matches:a.matchMedium(b||"all"),media:b||"all"}}}()),function(a){"function"==typeof define&&define.amd?define([],a):("object"==typeof exports,a())}(function(){var a,b,c;return c={convert:function(a,b){return b={},a.on=function(c,d){return(b[c]=b[c]||[]).push(d),a},a.emit=function(c){var d,e,f,g;if(b[c]){for(g=b[c],e=0,f=g.length;e<f;e++)d=g[e],d.apply(a,Array.prototype.slice.call(arguments,1));return a}},a}},window.Gridle={_inited:!1,_isReady:!1,_statesInCss:null,_statesFindedInCss:!1,_cssSettings:[],_states:[],_activeStates:[],_activeStatesNames:[],_inactiveStates:[],_inactiveStatesNames:[],_updatedStates:[],_updatedStatesNames:[],resizeTimeout:null,_settings:{onUpdate:null,debug:null,ignoredStates:[]},init:function(a){var c;return this._inited=!0,null!=(null!=a?a.ignoredStates:void 0)&&(c=a.ignoredStates.indexOf("default"))>-1&&a.ignoredStates.splice(c,1),a&&(this._settings=this._extend(this._settings,a)),this._debug("waiting for content to be fully loaded"),b(function(a){return function(){return a._parseCss()}}(this))},_extend:function(a,b){var c,d;for(c in b)d=b[c],a[c]=d;return a},_parseCss:function(){var a,b,c,d,e,f,g,h,i;for(c=0,e=document.styleSheets.length,i=!1;c<e;){try{if(g=document.styleSheets[c].cssText||document.styleSheets[c].cssRules||document.styleSheets[c].rules,"string"==typeof g)h=g.match(/#gridle-settings(?:\s*)\{(?:\s*)content(?:\s*):(?:\s*)\"(.+)\"(;\s*|\s*)\}/)&&RegExp.$1,h&&(h=h.toString().replace(/\\/g,""),h=JSON.parse(h),this._cssSettings=h,i=!0,this._cssSettings=h,this._statesInCss=h.states);else for(d in g)f=g[d],/#gridle-settings/.test(f.cssText)&&(h=f.cssText.toString().match(/:(.*);/)&&RegExp.$1,h=h.toString().replace(/\\/g,""),h=h.trim(),h=h.substr(1),h=h.substr(0,h.length-1),h=JSON.parse(h),null!=(null!=h?h.states:void 0))&&(this._cssSettings=h,this._statesInCss=h.states,i=!0)}catch(b){if(a=b,"SecurityError"!==a.name)throw a}c++}return this._statesInCss?this._processFindedStates():this._debug("no states found...")},_processFindedStates:function(){var a,b,c;this._debug("begin process finded states in css"),c=this._statesInCss;for(a in c)b=c[a],this._settings.ignoredStates.indexOf(a)===-1&&this._registerState(a,b);return this._launch()},_launch:function(){return this._debug("launch"),this._isReady=!0,this._crossEmit("ready"),this._addEvent(window,"resize",function(a){return function(b){return clearTimeout(a.resizeTimeout),a.resizeTimeout=setTimeout(function(){return a._onResize()},100)}}(this)),this._onResize()},_onResize:function(){var a;if(a=[],this._updateStatesStatus(),this.getActiveStatesNames().length&&this._debug("active states",this.getActiveStatesNames().join(",")),this.getInactiveStatesNames().length&&this._debug("inactive states",this.getInactiveStatesNames().join(",")),this.getUpdatedStatesNames().length)return this._debug("updated states",this.getUpdatedStatesNames().join(","))},_registerState:function(a,b,c){var d;return d={name:a,query:b.query,settings:b,status:null,previous_status:null,updateOnResize:null==c||c},this._states.push(d),this._debug("|--- register state",a,d)},_updateStatesStatus:function(){var a,b,c,d,e,f;a=this.getDefaultState(),b=this._states.indexOf(a),f=a.status,this._activeStates=[],this._activeStatesNames=[],this._inactiveStates=[],this._inactiveStatesNames=[],this._updatedStates=[],this._updatedStatesNames=[],d=this._states;for(c in d)e=d[c],e.updateOnResize&&(this._states[c].previous_status=e.status,this._validateState(e)?(this._states[c].status||(this._updatedStates.push(e),this._updatedStatesNames.push(e.name)),this._states[c].status=!0,this._activeStates.push(e),this._activeStatesNames.push(e.name)):"default"!==e.name&&(this._states[c].status&&(this._updatedStates.push(e),this._updatedStatesNames.push(e.name)),this._states[c].status=!1,this._inactiveStates.push(e),this._inactiveStatesNames.push(e.name)));if(this._activeStates.length?(this._states[b].status=!1,this._inactiveStates.push(a),this._inactiveStatesNames.push("default"),f&&(this._updatedStates.push(a),this._updatedStatesNames.push("default"))):(this._states[b].status=!0,this._activeStates.push(a),this._activeStatesNames.push("default"),f||(this._updatedStates.push(a),this._updatedStatesNames.push("default"))),this._updatedStates.length&&this._crossEmit("update",this._updatedStates,this._activeStates,this._inactiveStates),this._updatedStates.length&&this._settings.onUpdate)return this._settings.onUpdate(this._updatedStates,this._activeStates,this._inactiveStates)},_validateState:function(a){return function(a){return matchMedia(a.query).matches}}(this),_addEvent:function(a,b,c){return!!a&&(a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c)},_crossEmit:function(a){return"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery(this).trigger(a,Array.prototype.slice.call(arguments,1)),jQuery("body").trigger("gridle."+a,Array.prototype.slice.call(arguments,1))),this.emit.apply(this,arguments)},_ajax:function(a){var b,c;return b={type:a.type||"GET",url:a.url,success:a.success,error:a.error,dataType:a.dataType||"text",context:a.context},c=new XMLHttpRequest,b.context&&(c.context=b.context),c.open(b.type,b.url,!0),c.onreadystatechange=function(){var a;if(4!==c.readyState)return!1;switch(c.status){case 200:switch(b.dataType){case"json":a=JSON.parse(c.responseText);break;default:a=c.responseText}if(b.success)return b.success(a,c.status,c)}},c.send()},getDefaultState:function(){var a,b,c,d;for(c=this.getRegisteredStates(),a=0,b=c.length;a<b;a++)if(d=c[a],"default"===d.name)return d},getRegisteredStates:function(){return this._states},getUpdatedStates:function(){return this._updatedStates},getUpdatedStatesNames:function(){return this._updatedStatesNames},getActiveStates:function(){return this._activeStates},getActiveStatesNames:function(){return this._activeStatesNames},getInactiveStates:function(){return this._inactiveStates},getInactiveStatesNames:function(){return this._inactiveStatesNames},isActive:function(a){var b,c,d,e;c=!1,e=this._activeStatesNames;for(b in e)d=e[b],a===d&&(c=!0);return c},isReady:function(){return this._isReady},_debug:function(){if(this._settings.debug)return console.log("GRIDLE",arguments)}},a=!1,b=function(b){var c;return c=function(b){return a?void b():"complete"===document.readyState?(a=!0,void b()):void 0},window.addEventListener?window.addEventListener("load",function(c){return function(){return a=!0,b()}}(this),!1):window.attachEvent("onload",function(c){return function(){return a=!0,b()}}(this)),c(function(a){return function(){return b()}}(this))},c.convert(window.Gridle),b(function(){return setTimeout(function(){if(!Gridle._inited)return Gridle.init()},500)}),Gridle});